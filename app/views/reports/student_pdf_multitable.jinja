<!-- Author David Norris (22690264) -->
{% import "macros/charts.jinja" as charts %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/skeleton.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/normalize.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/reports.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/pdf.css') }}">
    {{ charts.chart_head(data, 'chartImage') }}
  </head>

<style>
  .highlight {
      background-color: #FFBF00 ;


  }
</style>
  <body>
  <div id='wrapper'>
    <img width='100%' height='auto' class='letterhead' src={{ url_for('static', filename='assets/letterhead.png', _external=True) }}/>
    <div class='data'>
      <div class='two-info-float'>
        <p>Student Logbook Hours</p>
        <p>Generated: {{data.date_generated}}</p>
      </div>
      <div class='row'>
        <h3 class='title'><small>Student:</small> {{data.student.name}} ({{(data.student.student_number|string).zfill(8)}})</h3>
      </div>
      <div class='row'>
        <div class='three columns vertical-fill'>
            <div>
                <h5>Hours Status: {{ 'PASSED' if ((max_hours - data.graph.total) <= 0) else 'UNPASSED' }}</h5>
                <table class='u-full-width'>
                    <tr>
                      <th>Total</th>
                      <td>{{data.graph.total  | round(2, 'common') }}</td>
                    </tr>
                    <tr>
                      <th>Remaining</th>
                      <td>{{[(max_hours - data.graph.total), 0] | max  | round(2, 'common') }}</td>
                    </tr>
                </table>
            </div>
        </div>
        <div class='three columns vertical-fill'>
          <h5>Unit Report</h5>
          <table>
            <thead>
              <tr>
                <th>
                  Units
                </th>
                <th> Hours </th>
              </tr>
            </thead>
          {% for unit_names in data.results%}
            <tr>
              <th>{{unit_names[0]}}</th>
              <td>{{unit_names[1] | round(2, 'common')}}</td>
            </tr>
          {% endfor %}
          </table>
        </div>
        <h5>HOURS BY PLACEMENT LOCATION</h5>
        {% for key, data in new_data.items() %}
          {% for unit_names in data.results%}
            <h5> {{unit_names[0]}} </h5>
          {% endfor %}

          <div class='six columns vertical-fill'>
            <div>
              <table class="u-full-width">
                <thead>
                  <tr>
                    <th>Location</th>
                    <th>Hours</th>
                  </tr>
                </thead>
                <tbody>
                  {% for location in data.locations %}
                  <tr>
                    <td>{{ location.location }}</td>
                    <td>{{ location.hours | round(2, 'common') }}</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        {% endfor %}

      </div>
      <div class="row">
      {% for key, data in new_data.items() %}
        <div class='12 columns'>
          {% for unit_names in data.results%}
          <h4> {{unit_names[0]}} </h4>
          {% endfor %}
          <h5>HOURS BY ACTIVITY AND AES DOMAIN</h5>
          <table class="u-full-width">
              <thead>
                  <tr>
                      <th></th>
                      <th colspan="5" style="text-align:left">Activity Type</th>
                  </tr>
                  <tr>
                      <th>AES Domains</th>
                      {% for activity in data.activity_names %}
                      <th>{{activity.activity}}</th>
                      {% endfor %}
                      <th>Total </th>
                  </tr>
              </thead>
              <tbody>
                {% for domain in data.domains %}
                <tr>
                    <td>{{domain.domain}}</td>
                    {% for activity in data.activity_names %}
                    {% if domain[activity.activityid] != 0 %}
                    <td><b>{{domain[activity.activityid] | round(2, 'common')}}</b></td>
                    {% else %}
                    <td>{{domain[activity.activityid] | round(2, 'common')}}</td>
                    {% endif %}
                    {% endfor %}
                    {% if domain.total != 0 %}
                    <td><b>{{domain.total | round(2, 'common')}}</b></td>
                    {% else %}
                    <td>{{domain.total | round(2, 'common')}}</td>
                    {% endif %}
                </tr>
                {% endfor %}
                <tr>
                    {% if data.total_row.domain == "Total"%}
                      <td><b>{{data.total_row.domain}}</b></td>
                    {% else %}
                      <td>{{data.total_row.domain}}</td>
                    {% endif %}
                    {% for activity in data.activity_names %}
                    {% if data.total_row[activity.activityid] != 0 %}
                    <td><b>{{data.total_row[activity.activityid] | round(2, 'common')}}</b></td>
                    {% else %}
                      <td>{{data.total_row[activity.activityid] | round(2, 'common')}}</td>
                    {% endif %}
                    {% endfor %}
                    {% if data.total_row.total != 0 %}
                    <td><b>{{data.total_row.total | round(2, 'common')}}</b></td>
                    {% else %}
                    <td>{{data.total_row.total | round(2, 'common')}}</td>
                    {% endif %}
                </tr>
            </tbody>
          </table>
        </div>
        {% endfor %}
      </div>
      <div class='row new_page'>
          <div class='twelve columns'>
            <img id='chartImage'></img>
            {{ charts.chart_div()}}
          </div>
      </div>
    </div>
    
  </div>
</body>
</html>
