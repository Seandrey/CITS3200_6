<!-- Author: David Norris (22690264), Lara Posel (22972221) -->
{% extends 'templates/auth_area.html' %}
{% set active_page = 'student' %}

{% block head %}
{% endblock %}

{% block header %}
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/reports.css') }}">
    <script>

        const searchFilterStudents = () => {
            // Author David Norris (22690264), Sean Ledesma (22752771)
            const filter = document.getElementById("myInput").value;
            const reg = new RegExp(`(^|\\s)${filter}`, 'i');

            const studentRows = document.querySelectorAll("#studTable > tbody > tr");
            for (let i = 0; i < studentRows.length; i++) {
                let studentRow = studentRows[i];
                const id = studentRow.getElementsByClassName("student-id-field")[0].textContent;
                const name = studentRow.getElementsByClassName("student-name-field")[0].textContent;

                if (name !== "" || id !== "") 
                    studentRow.style.display = reg.test(name) || reg.test(id) ? "" : "none";
            }
        }
    </script>
{% endblock %}

{% block content %}
<h3 id="studentTitle"><div>Student Reports</div></h3>

<div id = "searchContainer">
<i class="fa fa-search searchIcon" aria-hidden="true"></i>

<input type="text" class="searchBox" onkeyup="searchFilterStudents()" id="myInput" placeholder="Enter student name or ID...">
</div>
<div id='pdfcontainer'></div>
<div class="tableContainer card">
<table id="studTable">
    <thead>
    <tr id="headerRow">
        <th>Results</th>
        <th></th>
        <th></th>
        <th><button class="functionButton"><i class="fa fa-sort-amount-desc" aria-hidden="true"></i>  Sort</button></th>
        <th><button class="functionButton"><i class="fa fa-filter" aria-hidden="true"></i>  Filter</button></th>
    </tr>
    
    <tr id="headerRow2">
        <th>Student ID</th>
        <th>Student Name</th>
        <th></th>
        <th></th>
        <th></th>
    </tr>
    </thead>
    <tbody>
    {%- for student in students %}
    <tr>
        <td class="student-id-field">{{(student.id|string).zfill(8)}}</td>
        <td class="student-name-field">{{student.name}}</td>
        <td><a href='./student/{{student.id}}'><button class="makeReport">See Report</button></a></td>
        <td><a href="./logs/{{student.id}}"><button class="seeLogs">See Logs</button></a></td>
    </tr>
    {%- endfor %}
    </tbody>
</table>

{% endblock %}
